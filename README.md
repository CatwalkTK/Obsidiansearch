# Obsidian Vault AI検索

AIを活用したWebインターフェースで、あなたのObsidian Vaultのコンテンツを検索したり、チャットしたりすることができます。Vaultフォルダをアップロードし、あなたのノートに書かれた内容だけに基づいて質問をすることで、答えを得ることができます。

## 機能

-   **LLM選択可能**: Google GeminiまたはOpenAIのモデルを選択して対話できます。
-   **統合的スコアリング検索**: パスの一致度（ファイル名）、意味の近さ（セマンティック検索）、内容のキーワード一致度という複数の指標を統合的に評価する、高度な検索技術を採用。これにより、AIの視野を狭めることなく、複数の関連ファイルを横断して最も的確な情報を見つけ出し、検索精度を飛躍的に向上させます。
-   **プライバシー第一**: あなたのノートとAPIキーはブラウザ内でローカルに処理されます。サーバーにアップロードされることはなく、質問に必要な文脈のみがAIに送信されます。
-   **シンプルなインターフェース**: 直感的でクリーンなチャットインターフェースにより、スムーズな体験が可能です。
-   **Markdownサポート**: Vault内の`.md`ファイルをネイティブに理解し、処理します。

## 仕組み

1.  **AIプロバイダーの設定**: アプリケーションを開き、使用したいAIプロバイダー（GeminiまたはOpenAI）を選択し、対応するAPIキーを入力します。
2.  **Vaultの選択**: ファイルピッカーを使用して、お使いのObsidian Vaultのディレクトリを選択します。
3.  **ローカルでのベクトル化**: アプリケーションは、ブラウザ内で直接すべてのマークダウン(`.md`)ファイルを読み込み、意味のある小さな「チャンク」に分割します。その後、選択したAIモデルを使用して各チャンクをベクトル化（意味を数値配列に変換）し、検索可能なインデックスを作成します。
4.  **統合的スコアリングの実行**: あなたが質問をすると、システムはVault内のすべての情報の断片（チャンク）一つひとつに対して、以下の要素を基に総合的な関連度スコアを計算します。
    a.  **パススコア**: 質問のキーワードがチャンクの**ファイルパス**にどれだけ含まれているか。
    b.  **セマンティックスコア**: 質問の「意味」とチャンクの内容が文脈的にどれだけ近いか。
    c.  **コンテントスコア**: 質問のキーワードがチャンクの**本文**にどれだけ含まれているか。
5.  **インテリジェントなコンテキスト生成**:
    -   算出された総合スコアに基づき、すべてのチャンクが単一のリスト上で公平にランク付けされます。
    -   スコアが最も高い、複数のファイルにまたがる可能性のある、最も関連性の高いチャンクだけを厳選し、AIへのコンテキストとして使用します。
6.  **信頼性のある回答**: AIは、提供されたコンテキストの情報に**のみ**基づいて回答するよう特別に指示されています。これにより、回答があなた自身の知識ベースから得られることが保証されます。答えが見つからない場合は、その旨を伝えます。
7.  **回答の表示**: AIの応答がチャットインターフェースに表示されます。

## はじめに

### 前提条件

-   モダンなウェブブラウザ（例：Chrome, Firefox, Safari, Edge）。
-   Google Gemini APIキーまたはOpenAI APIキー。
    -   Gemini: [Google AI Studio](https://aistudio.google.com/app/apikey)から取得できます。
    -   OpenAI: [OpenAI Platform](https://platform.openai.com/api-keys)から取得できます。

### セットアップ

このプロジェクトは静的なウェブアプリケーションであり、特別なビルドプロセスなしで実行できます。

1.  **ファイルの準備**:
    -   すべてのプロジェクトファイル（`index.html`, `index.tsx`など）を一つのディレクトリに配置します。

2.  **ローカルサーバーで実行**:
    -   お好みのローカルウェブサーバーを使用して、プロジェクトファイルが置かれたディレクトリを配信します。
    -   もしNode.jsがインストールされているなら、ディレクトリ内で `npx serve .` を実行するのが簡単です。
    -   Pythonがインストールされている場合は、`python3 -m http.server` を使用できます。

3.  **アプリへのアクセス**: ウェブブラウザを開き、ローカルサーバーから提供されたURL（例：`http://localhost:3000`）にアクセスします。

## 使い方

1.  アプリケーションを開き、まず**AIプロバイダーを選択**し、あなたの**APIキーを入力**します。
2.  **「Vaultフォルダを選択」**エリアをクリックします。
3.  ファイル選択ダイアログで、あなたのObsidian Vaultのルートフォルダを選択します。
4.  ファイルが処理されるのを待ちます。チャットウィンドウの上部に、読み込まれたファイル数を示す確認メッセージが表示されます。
5.  下部の入力ボックスにノートに関する質問を入力し、`Enter`キーを押すか**「送信」**ボタンをクリックします。

## 技術スタック

-   **フロントエンド**: React, TypeScript, Tailwind CSS
-   **AI**: Google Gemini API (`@google/genai`), OpenAI API (`openai`)
-   **モジュールシステム**: `esm.sh`を介したブラウザ内ESモジュール